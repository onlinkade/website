<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>کافی نت آنالین کده - پنل مدیریت</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #1a2a6c;
            --secondary-color: #b21f1f;
            --accent-color: #fdbb2d;
            --card-bg: #ffffff;
            --text-color: #333333;
            --header-bg: rgba(255, 255, 255, 0.95);
            --header-font: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            --service-font: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color), var(--accent-color));
            color: var(--text-color);
            min-height: 100vh;
            padding: 20px;
            direction: rtl;
            transition: all 0.3s ease;
            padding-bottom: 100px; /* برای فوتتر */
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        header {
            background-color: var(--header-bg);
            border-radius: 15px;
            padding: 20px 25px;
            margin-bottom: 25px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
            position: relative;
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.3);
            transition: all 0.3s ease;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            font-family: var(--header-font);
        }
        
        .header-left {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .logo-container {
            position: relative;
        }
        
        .logo {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            object-fit: cover;
            border: 3px solid var(--primary-color);
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        }
        
        .logo:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.3);
        }
        
        .logo-tooltip {
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 10px 15px;
            border-radius: 8px;
            font-size: 0.9rem;
            width: 250px;
            text-align: center;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            z-index: 100;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }
        
        .logo-container:hover .logo-tooltip {
            opacity: 1;
            visibility: visible;
            bottom: 110%;
        }
        
        .logo-tooltip::after {
            content: '';
            position: absolute;
            top: 100%;
            left: 50%;
            transform: translateX(-50%);
            border: 8px solid transparent;
            border-top-color: rgba(0, 0, 0, 0.8);
        }
        
        .header-center {
            text-align: center;
            flex-grow: 1;
            margin: 0 20px;
        }
        
        .header-content {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
        }
        
        .header-icon {
            font-size: 2.5rem;
            color: var(--primary-color);
        }
        
        h1 {
            color: var(--primary-color);
            margin-bottom: 10px;
            font-size: 2.5rem;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            font-family: var(--header-font);
        }
        
        .header-subtitle {
            color: var(--secondary-color);
            font-size: 1.2rem;
            margin-top: 5px;
            transition: all 0.3s ease;
            font-family: var(--header-font);
        }
        
        .header-right {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .search-container {
            position: relative;
            width: 250px;
        }
        
        .search-input {
            width: 100%;
            padding: 12px 45px 12px 15px;
            border: 2px solid #ddd;
            border-radius: 30px;
            font-size: 1rem;
            transition: all 0.3s ease;
            background: #f9f9f9;
            outline: none;
        }
        
        .search-input:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(26, 42, 108, 0.2);
            background: white;
        }
        
        .search-icon {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: #777;
            font-size: 1.2rem;
        }
        
        .admin-login-btn {
            background: linear-gradient(135deg, #ff5722, #e64a19);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 50px;
            cursor: pointer;
            font-size: 1.1rem;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(230, 74, 25, 0.4);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            white-space: nowrap;
        }
        
        .admin-login-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(230, 74, 25, 0.6);
        }
        
        .admin-login-btn:active {
            transform: translateY(-1px);
        }
        
        .services-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }
        
        .service-card {
            background: linear-gradient(145deg, var(--card-bg), #f0f0f0);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 8px 8px 16px rgba(0, 0, 0, 0.1), 
                        -8px -8px 16px rgba(255, 255, 255, 0.7);
            transition: all 0.4s ease;
            display: flex;
            flex-direction: column;
            border: 1px solid rgba(255, 255, 255, 0.5);
            position: relative;
            overflow: hidden;
            font-family: var(--service-font);
        }
        
        .service-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 5px;
            background: linear-gradient(90deg, #ff5722, #ff9800, #ffeb3b);
        }
        
        .service-card:hover {
            transform: translateY(-10px) rotate(1deg);
            box-shadow: 12px 12px 25px rgba(0, 0, 0, 0.15), 
                        -12px -12px 25px rgba(255, 255, 255, 0.8);
        }
        
        .service-title {
            background: linear-gradient(135deg, #ffeb3b, #ffc107);
            padding: 12px;
            border-radius: 10px;
            margin-bottom: 20px;
            text-align: center;
            font-weight: bold;
            font-size: 1.3rem;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            position: relative;
            z-index: 1;
        }
        
        .service-link {
            background: linear-gradient(135deg, #4caf50, #388e3c);
            color: white;
            text-decoration: none;
            padding: 12px;
            border-radius: 10px;
            text-align: center;
            margin-top: auto;
            transition: all 0.3s ease;
            box-shadow: 0 4px 10px rgba(56, 142, 60, 0.4);
            position: relative;
            overflow: hidden;
            z-index: 1;
        }
        
        .service-link::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #388e3c, #2e7d32);
            z-index: -1;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .service-link:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(56, 142, 60, 0.6);
        }
        
        .service-link:hover::before {
            opacity: 1;
        }
        
        .login-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(5px);
        }
        
        .login-form {
            background: linear-gradient(145deg, #ffffff, #f5f5f5);
            padding: 40px;
            border-radius: 20px;
            width: 90%;
            max-width: 450px;
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.3);
            position: relative;
            transform: scale(0.9);
            animation: modalAppear 0.3s forwards;
            border: 1px solid rgba(255, 255, 255, 0.5);
        }
        
        @keyframes modalAppear {
            to {
                transform: scale(1);
            }
        }
        
        .login-form h2 {
            text-align: center;
            margin-bottom: 25px;
            color: var(--primary-color);
            font-size: 1.8rem;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #555;
        }
        
        .form-group input {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #ddd;
            border-radius: 10px;
            font-size: 1rem;
            transition: all 0.3s ease;
            background: #f9f9f9;
        }
        
        .form-group input:focus {
            border-color: #4caf50;
            box-shadow: 0 0 0 3px rgba(76, 175, 80, 0.2);
            background: white;
            outline: none;
        }
        
        .form-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 25px;
        }
        
        .password-actions {
            display: flex;
            justify-content: space-between;
            margin-top: 15px;
        }
        
        .password-action-btn {
            background: none;
            border: none;
            color: var(--primary-color);
            cursor: pointer;
            font-size: 0.9rem;
            text-decoration: underline;
            transition: all 0.3s ease;
        }
        
        .password-action-btn:hover {
            color: var(--secondary-color);
        }
        
        .submit-btn, .cancel-btn {
            padding: 12px 25px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s ease;
            font-weight: bold;
        }
        
        .submit-btn {
            background: linear-gradient(135deg, #4caf50, #388e3c);
            color: white;
            box-shadow: 0 4px 10px rgba(56, 142, 60, 0.4);
        }
        
        .submit-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(56, 142, 60, 0.6);
        }
        
        .cancel-btn {
            background: linear-gradient(135deg, #f44336, #d32f2f);
            color: white;
            box-shadow: 0 4px 10px rgba(211, 47, 47, 0.4);
        }
        
        .cancel-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(211, 47, 47, 0.6);
        }
        
        .admin-panel {
            display: none;
            background: linear-gradient(145deg, #ffffff, #f5f5f5);
            border-radius: 20px;
            padding: 30px;
            margin-top: 30px;
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.15);
            border: 1px solid rgba(255, 255, 255, 0.5);
        }
        
        .admin-panel h2 {
            color: var(--primary-color);
            margin-bottom: 25px;
            text-align: center;
            border-bottom: 3px solid var(--primary-color);
            padding-bottom: 15px;
            font-size: 2rem;
        }
        
        .admin-tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 2px solid #eee;
            flex-wrap: wrap;
        }
        
        .admin-tab {
            padding: 12px 25px;
            background: #f5f5f5;
            border: none;
            border-radius: 8px 8px 0 0;
            cursor: pointer;
            margin-left: 5px;
            transition: all 0.3s ease;
            font-weight: bold;
        }
        
        .admin-tab.active {
            background: var(--primary-color);
            color: white;
        }
        
        .admin-tab:hover:not(.active) {
            background: #e0e0e0;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .edit-forms-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }
        
        .edit-form {
            background: rgba(255, 255, 255, 0.7);
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
            border: 1px solid rgba(0, 0, 0, 0.05);
            position: relative;
        }
        
        .service-accordion {
            background: #f9f9f9;
            border: 1px solid #ddd;
            border-radius: 8px;
            margin-bottom: 10px;
            overflow: hidden;
        }
        
        .accordion-header {
            padding: 15px;
            background: #eee;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-weight: bold;
        }
        
        .accordion-content {
            padding: 0 15px;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }
        
        .accordion-content.open {
            padding: 15px;
            max-height: 1000px;
        }
        
        .style-controls {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 15px;
        }
        
        .style-control {
            margin-bottom: 10px;
        }
        
        .style-control label {
            display: block;
            margin-bottom: 5px;
            font-size: 0.9rem;
            font-weight: bold;
        }
        
        .style-control input, .style-control select {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        
        .color-preview {
            width: 30px;
            height: 30px;
            border-radius: 5px;
            display: inline-block;
            margin-right: 10px;
            vertical-align: middle;
            border: 1px solid #ddd;
        }
        
        .edit-form h3 {
            color: var(--primary-color);
            margin-bottom: 15px;
            text-align: center;
            padding-bottom: 10px;
            border-bottom: 2px dashed #ddd;
        }
        
        .edit-form label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #555;
        }
        
        .edit-form input {
            width: 100%;
            padding: 10px 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            margin-bottom: 15px;
            font-size: 1rem;
            transition: all 0.3s ease;
            background: #f9f9f9;
        }
        
        .edit-form input:focus {
            border-color: #2196f3;
            box-shadow: 0 0 0 3px rgba(33, 150, 243, 0.2);
            background: white;
            outline: none;
        }
        
        .save-btn, .logout-btn, .add-service-btn, .save-all-btn {
            padding: 12px 25px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s ease;
            font-weight: bold;
            display: block;
            margin: 10px auto;
        }
        
        .save-btn {
            background: linear-gradient(135deg, #2196f3, #1976d2);
            color: white;
            box-shadow: 0 4px 10px rgba(25, 118, 210, 0.4);
        }
        
        .save-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(25, 118, 210, 0.6);
        }
        
        .save-all-btn {
            background: linear-gradient(135deg, #9c27b0, #7b1fa2);
            color: white;
            box-shadow: 0 4px 10px rgba(123, 31, 162, 0.4);
            margin: 20px auto;
        }
        
        .save-all-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(123, 31, 162, 0.6);
        }
        
        .logout-btn {
            background: linear-gradient(135deg, #f44336, #d32f2f);
            color: white;
            box-shadow: 0 4px 10px rgba(211, 47, 47, 0.4);
        }
        
        .logout-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(211, 47, 47, 0.6);
        }
        
        .add-service-btn {
            background: linear-gradient(135deg, #9c27b0, #7b1fa2);
            color: white;
            box-shadow: 0 4px 10px rgba(123, 31, 162, 0.4);
            margin: 30px auto 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .add-service-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(123, 31, 162, 0.6);
        }
        
        .delete-btn {
            background: linear-gradient(135deg, #ff5722, #e64a19);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s ease;
            margin-top: 10px;
            width: 100%;
        }
        
        .delete-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(230, 74, 25, 0.4);
        }
        
        .header-editor {
            background: rgba(255, 255, 255, 0.7);
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
            border: 1px solid rgba(0, 0, 0, 0.05);
            margin-bottom: 20px;
        }
        
        .header-editor h3 {
            color: var(--primary-color);
            margin-bottom: 15px;
            text-align: center;
            padding-bottom: 10px;
            border-bottom: 2px dashed #ddd;
        }
        
        .header-controls {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
        
        .header-control {
            margin-bottom: 15px;
        }
        
        .header-control label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        
        .header-control input, .header-control textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        
        .header-control textarea {
            min-height: 80px;
            resize: vertical;
        }
        
        .logo-editor {
            background: rgba(255, 255, 255, 0.7);
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
            border: 1px solid rgba(0, 0, 0, 0.05);
            margin-bottom: 20px;
        }
        
        .logo-preview {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            object-fit: cover;
            border: 3px solid var(--primary-color);
            margin: 0 auto 15px;
            display: block;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        }
        
        .logo-upload-btn, .logo-remove-btn {
            background: linear-gradient(135deg, #2196f3, #1976d2);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            display: block;
            margin: 10px auto;
            transition: all 0.3s ease;
        }
        
        .logo-remove-btn {
            background: linear-gradient(135deg, #f44336, #d32f2f);
        }
        
        .logo-upload-btn:hover, .logo-remove-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(25, 118, 210, 0.4);
        }
        
        .logo-remove-btn:hover {
            box-shadow: 0 4px 8px rgba(211, 47, 47, 0.4);
        }
        
        .file-input-container {
            position: relative;
            overflow: hidden;
            display: inline-block;
            width: 100%;
        }
        
        .file-input {
            position: absolute;
            left: 0;
            top: 0;
            opacity: 0;
            width: 100%;
            height: 100%;
            cursor: pointer;
        }
        
        .file-input-label {
            display: block;
            padding: 10px 15px;
            background: #f0f0f0;
            border: 2px dashed #ccc;
            border-radius: 8px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .file-input-label:hover {
            background: #e0e0e0;
            border-color: #999;
        }
        
        .notification {
            position: fixed;
            top: 30px;
            right: 30px;
            padding: 15px 25px;
            border-radius: 10px;
            color: white;
            font-weight: bold;
            z-index: 1001;
            display: none;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            animation: slideIn 0.3s forwards;
        }
        
        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        
        .success {
            background: linear-gradient(135deg, #4caf50, #388e3c);
        }
        
        .error {
            background: linear-gradient(135deg, #f44336, #d32f2f);
        }
        
        .no-results {
            text-align: center;
            padding: 30px;
            font-size: 1.2rem;
            color: #777;
            grid-column: 1 / -1;
        }
        
        .password-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(5px);
        }
        
        .password-form {
            background: linear-gradient(145deg, #ffffff, #f5f5f5);
            padding: 40px;
            border-radius: 20px;
            width: 90%;
            max-width: 450px;
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.3);
            position: relative;
            transform: scale(0.9);
            animation: modalAppear 0.3s forwards;
            border: 1px solid rgba(255, 255, 255, 0.5);
        }
        
        .storage-status {
            position: fixed;
            top: 10px;
            left: 10px;
            background: #4caf50;
            color: white;
            padding: 10px;
            border-radius: 5px;
            z-index: 9999;
            font-size: 14px;
        }
        
        .debug-btn {
            position: fixed;
            bottom: 10px;
            right: 10px;
            z-index: 9999;
            padding: 10px;
            background: #f44336;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        
        /* استایل فوتر شیشه‌ای */
        .glass-footer {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-top: 1px solid rgba(255, 255, 255, 0.3);
            padding: 15px 0;
            z-index: 1000;
            box-shadow: 0 -5px 20px rgba(0, 0, 0, 0.1);
        }
        
        .footer-icons {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 25px;
            flex-wrap: wrap;
            max-width: 90%;
            margin: 0 auto;
        }
        
        .footer-icon {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            background: rgba(255, 255, 255, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.3);
            position: relative;
        }
        
        .footer-icon:hover {
            transform: translateY(-5px);
            background: rgba(255, 255, 255, 0.3);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        .footer-icon i {
            font-size: 1.5rem;
            color: rgba(255, 255, 255, 0.9);
            text-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }
        
        .footer-tooltip {
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 0.8rem;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            z-index: 100;
            margin-bottom: 10px;
        }
        
        .footer-icon:hover .footer-tooltip {
            opacity: 1;
            visibility: visible;
        }
        
        .footer-tooltip::after {
            content: '';
            position: absolute;
            top: 100%;
            left: 50%;
            transform: translateX(-50%);
            border: 6px solid transparent;
            border-top-color: rgba(0, 0, 0, 0.8);
        }
        
        /* دکمه مدیریت فوتر */
        .footer-admin-btn {
            position: fixed;
            bottom: 80px;
            left: 20px;
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 8px;
            cursor: pointer;
            z-index: 1001;
            transition: all 0.3s ease;
            font-weight: bold;
        }
        
        .footer-admin-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }
        
        /* مودال مدیریت فوتر */
        .footer-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            z-index: 2000;
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(5px);
        }
        
        .footer-form {
            background: linear-gradient(145deg, #ffffff, #f5f5f5);
            padding: 30px;
            border-radius: 20px;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.3);
            position: relative;
        }
        
        .footer-form h2 {
            text-align: center;
            margin-bottom: 20px;
            color: #1a2a6c;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #555;
        }
        
        .form-group input, .form-group select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 1rem;
        }
        
        .form-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
        }
        
        .icon-preview {
            display: flex;
            justify-content: center;
            margin: 15px 0;
        }
        
        .preview-icon {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(26, 42, 108, 0.1);
            border: 1px solid rgba(26, 42, 108, 0.2);
        }
        
        .preview-icon i {
            font-size: 1.2rem;
            color: #1a2a6c;
        }
        
        /* استایل‌های جدید برای بخش‌های جدید */
        .import-export-section {
            background: rgba(255, 255, 255, 0.7);
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
            border: 1px solid rgba(0, 0, 0, 0.05);
            margin-bottom: 20px;
        }
        
        .import-export-section h3 {
            color: var(--primary-color);
            margin-bottom: 15px;
            text-align: center;
            padding-bottom: 10px;
            border-bottom: 2px dashed #ddd;
        }
        
        .import-export-controls {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .import-export-controls textarea {
            width: 100%;
            min-height: 150px;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-family: monospace;
        }
        
        .import-export-buttons {
            display: flex;
            gap: 10px;
            justify-content: center;
        }
        
        .import-btn, .export-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }
        
        .import-btn {
            background: linear-gradient(135deg, #4caf50, #388e3c);
            color: white;
        }
        
        .export-btn {
            background: linear-gradient(135deg, #2196f3, #1976d2);
            color: white;
        }
        
        .import-btn:hover, .export-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        
        .excel-controls {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-top: 20px;
        }
        
        .excel-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .excel-import-btn {
            background: linear-gradient(135deg, #4caf50, #388e3c);
            color: white;
        }
        
        .excel-export-btn {
            background: linear-gradient(135deg, #2196f3, #1976d2);
            color: white;
        }
        
        .excel-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        
        @media (max-width: 768px) {
            header {
                flex-direction: column;
                gap: 15px;
            }
            
            .header-center {
                margin: 10px 0;
                order: 3;
                width: 100%;
            }
            
            .services-grid {
                grid-template-columns: 1fr;
            }
            
            .edit-forms-container {
                grid-template-columns: 1fr;
            }
            
            .style-controls, .header-controls {
                grid-template-columns: 1fr;
            }
            
            h1 {
                font-size: 2rem;
            }
            
            .admin-panel h2 {
                font-size: 1.6rem;
            }
            
            .admin-tabs {
                flex-direction: column;
            }
            
            .admin-tab {
                margin-bottom: 5px;
                border-radius: 8px;
            }
            
            .search-container {
                width: 100%;
            }
            
            .footer-icons {
                gap: 15px;
            }
            
            .footer-icon {
                width: 45px;
                height: 45px;
            }
            
            .footer-icon i {
                font-size: 1.3rem;
            }
        }
    </style>
</head>
<body>
    <div class="storage-status" id="storageStatus">✅ localStorage فعال است</div>
    
    <div class="container">
        <header>
            <div class="header-left">
                <div class="logo-container">
                    <img src="https://via.placeholder.com/150/1a2a6c/ffffff?text=LOGO" alt="لوگو کافی نت" class="logo" id="siteLogo">
                    <div class="logo-tooltip" id="logoTooltip">
                        <!-- محتوای تولتیپ به صورت داینامیک پر می‌شود -->
                    </div>
                </div>
            </div>
            
            <div class="header-center">
                <div class="header-content">
                    <i class="fas fa-laptop-code header-icon" id="headerIconElement"></i>
                    <div>
                        <h1 id="siteTitle">کافی نت آنالین کده</h1>
                        <div class="header-subtitle" id="siteSubtitle">ارائه خدمات اینترنتی و آنلاین</div>
                    </div>
                </div>
            </div>
            
            <div class="header-right">
                <div class="search-container">
                    <input type="text" class="search-input" id="searchInput" placeholder="جستجوی سرویس...">
                    <i class="fas fa-search search-icon"></i>
                </div>
                <button class="admin-login-btn" id="adminLoginBtn">
                    <i class="fas fa-user-shield"></i>
                    ورود مدیر
                </button>
            </div>
        </header>
        
        <div class="services-grid" id="servicesGrid">
            <!-- سرویس‌ها به صورت داینامیک ساخته می‌شوند -->
        </div>
        
        <div class="admin-panel" id="adminPanel">
            <h2>پنل مدیریت</h2>
            
            <div class="admin-tabs">
                <button class="admin-tab active" data-tab="services">مدیریت سرویس‌ها</button>
                <button class="admin-tab" data-tab="header">ویرایش هدر</button>
                <button class="admin-tab" data-tab="logo">مدیریت لوگو</button>
                <button class="admin-tab" data-tab="appearance">تنظیمات ظاهری</button>
                <button class="admin-tab" data-tab="importExport">وارد کردن / صادر کردن</button>
                <button class="admin-tab" data-tab="footer">مدیریت فوتر</button>
            </div>
            
            <div class="tab-content active" id="services-tab">
                <button class="add-service-btn" id="addServiceBtn">
                    <i class="fas fa-plus-circle"></i>
                    افزودن سرویس جدید
                </button>
                <div class="edit-forms-container" id="adminForms">
                    <!-- فرم‌های ویرایش به صورت داینامیک ساخته می‌شوند -->
                </div>
            </div>
            
            <div class="tab-content" id="header-tab">
                <div class="header-editor">
                    <h3>ویرایش هدر سایت</h3>
                    <div class="header-controls">
                        <div class="header-control">
                            <label for="headerTitle">عنوان سایت:</label>
                            <input type="text" id="headerTitle" value="کافی نت آنالین کده">
                        </div>
                        <div class="header-control">
                            <label for="headerSubtitle">زیرعنوان:</label>
                            <input type="text" id="headerSubtitle" value="ارائه خدمات اینترنتی و آنلاین">
                        </div>
                        <div class="header-control">
                            <label for="headerIcon">آیکون (کلاس FontAwesome):</label>
                            <input type="text" id="headerIcon" value="fas fa-laptop-code">
                        </div>
                        <div class="header-control">
                            <label for="headerFont">فونت هدر:</label>
                            <select id="headerFont">
                                <option value="'Segoe UI', Tahoma, Geneva, Verdana, sans-serif">Segoe UI</option>
                                <option value="'B Nazanin', 'B Yekan', Tahoma">B Nazanin</option>
                                <option value="Arial, Helvetica, sans-serif">Arial</option>
                                <option value="'Times New Roman', Times, serif">Times New Roman</option>
                            </select>
                        </div>
                        <div class="header-control">
                            <label for="headerColor">رنگ عنوان:</label>
                            <input type="color" id="headerColor" value="#1a2a6c">
                        </div>
                        <div class="header-control">
                            <label for="headerBgColor">رنگ پس‌زمینه هدر:</label>
                            <input type="color" id="headerBgColor" value="#ffffff">
                        </div>
                        <div class="header-control">
                            <label for="headerTextColor">رنگ متن هدر:</label>
                            <input type="color" id="headerTextColor" value="#333333">
                        </div>
                        <div class="header-control">
                            <label>آپلود آیکون از سیستم:</label>
                            <div class="file-input-container">
                                <input type="file" id="headerIconUpload" class="file-input" accept="image/*">
                                <label for="headerIconUpload" class="file-input-label">
                                    <i class="fas fa-upload"></i> انتخاب آیکون
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="tab-content" id="logo-tab">
                <div class="logo-editor">
                    <h3>مدیریت لوگو و اطلاعات دفتر</h3>
                    <img src="https://via.placeholder.com/150/1a2a6c/ffffff?text=LOGO" alt="پیش‌نمایش لوگو" class="logo-preview" id="logoPreview">
                    
                    <div class="header-controls">
                        <div class="header-control">
                            <label>آپلود لوگو از سیستم:</label>
                            <div class="file-input-container">
                                <input type="file" id="logoUpload" class="file-input" accept="image/*">
                                <label for="logoUpload" class="file-input-label">
                                    <i class="fas fa-upload"></i> انتخاب فایل لوگو
                                </label>
                            </div>
                        </div>
                        <div class="header-control">
                            <label for="officeName">نام دفتر/مغازه:</label>
                            <input type="text" id="officeName" value="کافی نت آنالین کده">
                        </div>
                        <div class="header-control">
                            <label for="officeAddress">آدرس:</label>
                            <input type="text" id="officeAddress" value="تهران، خیابان انقلاب، پلاک ۱۲۳">
                        </div>
                        <div class="header-control">
                            <label for="officePhone">تلفن:</label>
                            <input type="text" id="officePhone" value="۰۲۱-۱۲۳۴۵۶۷۸">
                        </div>
                        <div class="header-control">
                            <label for="officeHours">ساعات کاری:</label>
                            <input type="text" id="officeHours" value="شنبه تا پنجشنبه: ۸ صبح تا ۱۰ شب">
                        </div>
                        <div class="header-control">
                            <label for="officeDescription">توضیحات اضافی:</label>
                            <textarea id="officeDescription">کافی نت آنالین کده با بیش از ۱۰ سال سابقه در ارائه خدمات اینترنتی و کامپیوتری</textarea>
                        </div>
                    </div>
                    
                    <button class="logo-upload-btn" id="updateLogoBtn">
                        <i class="fas fa-sync-alt"></i>
                        بروزرسانی اطلاعات
                    </button>
                    
                    <button class="logo-remove-btn" id="removeLogoBtn">
                        <i class="fas fa-trash"></i>
                        حذف لوگو
                    </button>
                </div>
            </div>
            
            <div class="tab-content" id="appearance-tab">
                <div class="header-editor">
                    <h3>تنظیمات ظاهری سایت</h3>
                    <div class="header-controls">
                        <div class="header-control">
                            <label for="primaryColor">رنگ اصلی:</label>
                            <input type="color" id="primaryColor" value="#1a2a6c">
                        </div>
                        <div class="header-control">
                            <label for="secondaryColor">رنگ ثانویه:</label>
                            <input type="color" id="secondaryColor" value="#b21f1f">
                        </div>
                        <div class="header-control">
                            <label for="accentColor">رنگ تأکیدی:</label>
                            <input type="color" id="accentColor" value="#fdbb2d">
                        </div>
                        <div class="header-control">
                            <label for="cardBgColor">رنگ پس‌زمینه کارت‌ها:</label>
                            <input type="color" id="cardBgColor" value="#ffffff">
                        </div>
                        <div class="header-control">
                            <label for="textColor">رنگ متن:</label>
                            <input type="color" id="textColor" value="#333333">
                        </div>
                        <div class="header-control">
                            <label for="fontFamily">فونت اصلی سایت:</label>
                            <select id="fontFamily">
                                <option value="'Segoe UI', Tahoma, Geneva, Verdana, sans-serif">Segoe UI</option>
                                <option value="'B Nazanin', 'B Yekan', Tahoma">B Nazanin</option>
                                <option value="Arial, Helvetica, sans-serif">Arial</option>
                                <option value="'Times New Roman', Times, serif">Times New Roman</option>
                            </select>
                        </div>
                        <div class="header-control">
                            <label for="serviceFont">فونت سرویس‌ها:</label>
                            <select id="serviceFont">
                                <option value="'Segoe UI', Tahoma, Geneva, Verdana, sans-serif">Segoe UI</option>
                                <option value="'B Nazanin', 'B Yekan', Tahoma">B Nazanin</option>
                                <option value="Arial, Helvetica, sans-serif">Arial</option>
                                <option value="'Times New Roman', Times, serif">Times New Roman</option>
                            </select>
                        </div>
                        <div class="header-control">
                            <label>آپلود فونت از سیستم:</label>
                            <div class="file-input-container">
                                <input type="file" id="fontUpload" class="file-input" accept=".ttf,.otf,.woff,.woff2">
                                <label for="fontUpload" class="file-input-label">
                                    <i class="fas fa-upload"></i> انتخاب فایل فونت
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="tab-content" id="importExport-tab">
                <div class="import-export-section">
                    <h3>وارد کردن / صادر کردن داده‌ها</h3>
                    <div class="import-export-controls">
                        <h4>صادر کردن / وارد کردن با JSON</h4>
                        <label for="jsonData">داده‌های JSON:</label>
                        <textarea id="jsonData" placeholder="داده‌های JSON را اینجا وارد کنید..."></textarea>
                        <div class="import-export-buttons">
                            <button class="import-btn" id="importDataBtn">
                                <i class="fas fa-file-import"></i>
                                وارد کردن داده‌ها
                            </button>
                            <button class="export-btn" id="exportDataBtn">
                                <i class="fas fa-file-export"></i>
                                صادر کردن داده‌ها
                            </button>
                        </div>
                    </div>
                    
                    <div class="excel-controls">
                        <h4>صادر کردن / وارد کردن با Excel</h4>
                        <button class="excel-btn excel-export-btn" id="exportExcelBtn">
                            <i class="fas fa-file-excel"></i>
                            صادر کردن به Excel
                        </button>
                        <div class="file-input-container">
                            <input type="file" id="excelImport" class="file-input" accept=".xlsx,.xls">
                            <label for="excelImport" class="file-input-label">
                                <i class="fas fa-file-import"></i> وارد کردن از Excel
                            </label>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="tab-content" id="footer-tab">
                <div class="header-editor">
                    <h3>مدیریت فوتر</h3>
                    <p>برای مدیریت آیکون‌های فوتر از دکمه "مدیریت فوتر" در پایین صفحه استفاده کنید.</p>
                    <p>آیکون‌های فعلی:</p>
                    <div id="footerIconsList">
                        <!-- لیست آیکون‌های فوتر -->
                    </div>
                </div>
            </div>
            
            <button class="save-all-btn" id="saveAllBtn">
                <i class="fas fa-save"></i>
                ذخیره تمام تغییرات در سیستم
            </button>
            
            <button class="logout-btn" id="logoutBtn">
                <i class="fas fa-sign-out-alt"></i>
                خروج از پنل مدیریت
            </button>
        </div>
    </div>
    
    <!-- فوتر شیشه‌ای -->
    <footer class="glass-footer" id="glassFooter">
        <div class="footer-icons" id="footerIcons">
            <!-- آیکون‌ها به صورت داینامیک اضافه می‌شوند -->
        </div>
    </footer>
    
    <!-- دکمه مدیریت فوتر -->
    <button class="footer-admin-btn" id="footerAdminBtn">
        <i class="fas fa-cog"></i> مدیریت فوتر
    </button>
    
    <!-- مودال اطلاعات دفتر -->
    <div class="login-modal" id="officeInfoModal">
        <div class="login-form">
            <h2>اطلاعات دفتر</h2>
            <div class="form-group">
                <div style="text-align: center; margin-bottom: 20px;">
                    <img src="https://via.placeholder.com/150/1a2a6c/ffffff?text=LOGO" alt="لوگو" class="logo-preview" style="width: 100px; height: 100px;">
                </div>
                <div id="officeInfoContent">
                    <!-- محتوای اطلاعات دفتر به صورت داینامیک پر می‌شود -->
                </div>
            </div>
            <div class="form-buttons">
                <button class="cancel-btn" id="closeOfficeInfo">بستن</button>
            </div>
        </div>
    </div>
 
    <!-- مودال مدیریت فوتر -->
   
 <div class="footer-modal" id="footerModal">
        <div class="footer-form">
            <h2>مدیریت آیکون‌های فوتر</h2><label for="iconmaneger">آپلود آیکون از سیستم:</label>
            <div class="form-group"><div class="file-input-container">
        <input type="file" id="footerIconUpload" class="file-input" accept="image/*">
        <label for="footerIconUpload" class="file-input-label">
            <i class="fas fa-upload"></i> انتخاب فایل آیکون
        </label>
    </div>
                <label for="iconSelect">انتخاب آیکون:</label>
                <select id="iconSelect">
                    <option value="fas fa-home">خانه</option>
                    <option value="fas fa-envelope">ایمیل</option>
                    <option value="fas fa-phone">تلفن</option>
                    <option value="fas fa-info-circle">اطلاعات</option>
                    <option value="fas fa-globe">وبسایت</option>
                    <option value="fas fa-user">پروفایل</option>
                    <option value="fas fa-shopping-cart">فروشگاه</option>
                    <option value="fas fa-gamepad">بازی</option>
                    <option value="fas fa-film">ویدیو</option>
                    <option value="fas fa-music">موسیقی</option>
                </select>
            </div>
            <div class="form-group">
                <label for="iconUrl">آدرس سایت:</label>
                <input type="text" id="iconUrl" placeholder="https://example.com">
            </div>
            <div class="form-group">
                <label for="iconTooltip">متن راهنما:</label>
                <input type="text" id="iconTooltip" placeholder="متن نمایش داده شده هنگام هاور">
            </div>
            <div class="icon-preview">
                <div class="preview-icon">
                    <i id="iconPreview"></i>
                </div>
            </div>
            <div class="form-buttons">
                <button class="cancel-btn" id="cancelFooter">لغو</button>
                <button class="submit-btn" id="addFooterIcon">افزودن آیکون</button>
            </div>
            <div id="footerIconsListModal" style="margin-top: 20px;">
                <!-- لیست آیکون‌های موجود -->
            </div>
        </div>
    </div>
    
    <div class="login-modal" id="loginModal">
        <div class="login-form">
            <h2>ورود به پنل مدیریت</h2>
            <div class="form-group">
                <label for="password">رمز عبور:</label>
                <input type="password" id="password" placeholder="رمز عبور را وارد کنید">
            </div>
            <div class="form-buttons">
                <button class="cancel-btn" id="cancelLogin">لغو</button>
                <button class="submit-btn" id="submitLogin">ورود</button>
            </div>
            <div class="password-actions">
                <button class="password-action-btn" id="changePasswordBtn">تغییر رمز</button>
            </div>
        </div>
    </div>
    
    <div class="password-modal" id="forgotPasswordModal">
        <div class="password-form">
            <h2>فراموشی رمز عبور</h2>
            <div class="form-group">
                <label>کد بازیابی: <strong>4380434729</strong></label>
                <input type="password" id="newPassword1" placeholder="رمز عبور جدید">
                <input type="password" id="newPassword2" placeholder="تکرار رمز عبور جدید">
            </div>
            <div class="form-buttons">
                <button class="cancel-btn" id="cancelForgotPassword">لغو</button>
                <button class="submit-btn" id="submitNewPassword">تغییر رمز</button>
            </div>
        </div>
    </div>
    
    <div class="password-modal" id="changePasswordModal">
        <div class="password-form">
            <h2>تغییر رمز عبور</h2>
            <div class="form-group">
                <input type="password" id="currentPassword" placeholder="رمز عبور فعلی">
                <input type="password" id="newChangePassword1" placeholder="رمز عبور جدید">
                <input type="password" id="newChangePassword2" placeholder="تکرار رمز عبور جدید">
            </div>
            <div class="form-buttons">
                <button class="cancel-btn" id="cancelChangePassword">لغو</button>
                <button class="submit-btn" id="submitChangePassword">تغییر رمز</button>
            </div>
        </div>
    </div>
    
    <div class="notification" id="notification"></div>
    
    <button class="debug-btn" id="debugBtn">🔄 ریست داده‌ها</button>

    <!-- کتابخانه‌های مورد نیاز برای کار با Excel -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

    <script>
        // داده‌های اولیه
        let services = [
            { id: 1, title: "وام فرزند آوری", url: "https://example.com/child-loan", linkText: "ورود به سایت", 
              titleColor: "#ffeb3b", titleBg: "linear-gradient(135deg, #ffeb3b, #ffc107)", 
              buttonColor: "#4caf50", buttonBg: "linear-gradient(135deg, #4caf50, #388e3c)" },
            { id: 2, title: "وام ازدواج", url: "https://example.com/marriage-loan", linkText: "ورود به سایت",
              titleColor: "#ffeb3b", titleBg: "linear-gradient(135deg, #ffeb3b, #ffc107)", 
              buttonColor: "#4caf50", buttonBg: "linear-gradient(135deg, #4caf50, #388e3c)" },
            { id: 3, title: "سخا", url: "https://example.com/sakha", linkText: "ورود به سایت",
              titleColor: "#ffeb3b", titleBg: "linear-gradient(135deg, #ffeb3b, #ffc107)", 
              buttonColor: "#4caf50", buttonBg: "linear-gradient(135deg, #4caf50, #388e3c)" },
            { id: 4, title: "ایران خودرو", url: "https://example.com/iran-khodro", linkText: "ورود به سایت",
              titleColor: "#ffeb3b", titleBg: "linear-gradient(135deg, #ffeb3b, #ffc107)", 
              buttonColor: "#4caf50", buttonBg: "linear-gradient(135deg, #4caf50, #388e3c)" }
        ];

        let headerSettings = {
            title: "کافی نت آنالین کده",
            subtitle: "ارائه خدمات اینترنتی و آنلاین",
            icon: "fas fa-laptop-code",
            titleColor: "#1a2a6c",
            bgColor: "#ffffff",
            textColor: "#333333",
            font: "'Segoe UI', Tahoma, Geneva, Verdana, sans-serif"
        };

        let logoSettings = {
            logoUrl: "https://via.placeholder.com/150/1a2a6c/ffffff?text=LOGO",
            officeName: "کافی نت آنالین کده",
            officeAddress: "تهران، خیابان انقلاب، پلاک ۱۲۳",
            officePhone: "۰۲۱-۱۲۳۴۵۶۷۸",
            officeHours: "شنبه تا پنجشنبه: ۸ صبح تا ۱۰ شب",
            officeDescription: "کافی نت آنالین کده با بیش از ۱۰ سال سابقه در ارائه خدمات اینترنتی و کامپیوتری"
        };

        let appearanceSettings = {
            primaryColor: "#1a2a6c",
            secondaryColor: "#b21f1f",
            accentColor: "#fdbb2d",
            cardBgColor: "#ffffff",
            textColor: "#333333",
            fontFamily: "'Segoe UI', Tahoma, Geneva, Verdana, sans-serif",
            serviceFont: "'Segoe UI', Tahoma, Geneva, Verdana, sans-serif"
        };

        // داده‌های اولیه آیکون‌های فوتر
        let footerIcons = [
            { icon: "fas fa-home", url: "https://example.com", tooltip: "صفحه اصلی" },
            { icon: "fas fa-envelope", url: "mailto:info@example.com", tooltip: "ارسال ایمیل" },
            { icon: "fas fa-phone", url: "tel:+98123456789", tooltip: "تماس با ما" },
            { icon: "fas fa-info-circle", url: "https://example.com/about", tooltip: "درباره ما" }
        ];

        let adminPassword = "1234";
        let nextId = 5;

        // بررسی فعال بودن localStorage
        function isLocalStorageAvailable() {
            try {
                const test = 'test';
                localStorage.setItem(test, test);
                localStorage.removeItem(test);
                return true;
            } catch (e) {
                console.error('localStorage در دسترس نیست:', e);
                return false;
            }
        }

        // بررسی وضعیت ذخیره‌سازی
        function checkStorageStatus() {
            const statusEl = document.getElementById('storageStatus');
            if (isLocalStorageAvailable()) {
                statusEl.style.background = '#4caf50';
                statusEl.textContent = '✅ localStorage فعال است';
            } else {
                statusEl.style.background = '#f44336';
                statusEl.textContent = '❌ localStorage غیرفعال است';
            }
        }

        // بارگذاری داده‌ها از localStorage
        function loadData() {
            if (!isLocalStorageAvailable()) {
                showNotification('localStorage در دسترس نیست. تغییرات ذخیره نخواهند شد.', 'error');
                return;
            }

            try {
                const savedServices = localStorage.getItem('kafinetServices');
                const savedHeader = localStorage.getItem('kafinetHeader');
                const savedLogo = localStorage.getItem('kafinetLogo');
                const savedAppearance = localStorage.getItem('kafinetAppearance');
                const savedFooter = localStorage.getItem('kafinetFooterIcons');
                const savedPassword = localStorage.getItem('kafinetPassword');
                
                console.log('بارگذاری داده‌ها از localStorage:');
                console.log('- خدمات:', savedServices ? 'موجود' : 'ندارد');
                console.log('- هدر:', savedHeader ? 'موجود' : 'ندارد');
                console.log('- لوگو:', savedLogo ? 'موجود' : 'ندارد');
                console.log('- ظاهر:', savedAppearance ? 'موجود' : 'ندارد');
                console.log('- فوتر:', savedFooter ? 'موجود' : 'ندارد');
                console.log('- رمز:', savedPassword ? 'موجود' : 'ندارد');
                
                if (savedServices) {
                    services = JSON.parse(savedServices);
                    nextId = services.length > 0 ? Math.max(...services.map(s => s.id)) + 1 : 5;
                }
                
                if (savedHeader) {
                    headerSettings = JSON.parse(savedHeader);
                }
                
                if (savedLogo) {
                    logoSettings = JSON.parse(savedLogo);
                }
                
                if (savedAppearance) {
                    appearanceSettings = JSON.parse(savedAppearance);
                }
                
                if (savedFooter) {
                    footerIcons = JSON.parse(savedFooter);
                }
                
                if (savedPassword) {
                    adminPassword = savedPassword;
                }
                
                console.log('داده‌ها با موفقیت بارگذاری شدند');
            } catch (error) {
                console.error('خطا در بارگذاری داده‌ها:', error);
                showNotification('خطا در بارگذاری داده‌های ذخیره شده', 'error');
            }
        }

        // ذخیره داده‌ها در localStorage
        function saveData() {
            if (!isLocalStorageAvailable()) {
                showNotification('localStorage در دسترس نیست. تغییرات ذخیره نخواهند شد.', 'error');
                return;
            }

            try {
                localStorage.setItem('kafinetServices', JSON.stringify(services));
                localStorage.setItem('kafinetHeader', JSON.stringify(headerSettings));
                localStorage.setItem('kafinetLogo', JSON.stringify(logoSettings));
                localStorage.setItem('kafinetAppearance', JSON.stringify(appearanceSettings));
                localStorage.setItem('kafinetFooterIcons', JSON.stringify(footerIcons));
                localStorage.setItem('kafinetPassword', adminPassword);
                
                console.log('ذخیره داده‌ها در localStorage:');
                console.log('- خدمات:', services.length + ' مورد');
                console.log('- هدر:', headerSettings);
                console.log('- لوگو:', logoSettings);
                console.log('- ظاهر:', appearanceSettings);
                console.log('- فوتر:', footerIcons.length + ' آیکون');
                console.log('- رمز:', '***' + adminPassword.substring(3));
                
                showNotification('تمام تغییرات با موفقیت ذخیره شد', 'success');
            } catch (error) {
                console.error('خطا در ذخیره داده‌ها:', error);
                showNotification('خطا در ذخیره‌سازی داده‌ها', 'error');
            }
        }

        // تابع برای ریست کردن تمام داده‌ها
        function resetAllData() {
            if (confirm('آیا از ریست کردن تمام داده‌ها اطمینان دارید؟ این عمل غیرقابل بازگشت است.')) {
                localStorage.clear();
                location.reload();
            }
        }

        // نمایش اعلان
        function showNotification(message, type) {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.className = `notification ${type}`;
            notification.style.display = 'block';
            
            setTimeout(() => {
                notification.style.display = 'none';
            }, 3000);
        }

        // اعمال تنظیمات هدر
        function applyHeaderSettings() {
            document.getElementById('siteTitle').textContent = headerSettings.title;
            document.getElementById('siteSubtitle').textContent = headerSettings.subtitle;
            
            const headerIcon = document.querySelector('.header-icon');
            headerIcon.className = headerSettings.icon + ' header-icon';
            
            document.querySelector('h1').style.color = headerSettings.titleColor;
            document.querySelector('header').style.backgroundColor = headerSettings.bgColor;
            document.querySelector('header').style.color = headerSettings.textColor;
            document.querySelector('header').style.fontFamily = headerSettings.font;
            
            // به‌روزرسانی مقادیر فرم
            document.getElementById('headerTitle').value = headerSettings.title;
            document.getElementById('headerSubtitle').value = headerSettings.subtitle;
            document.getElementById('headerIcon').value = headerSettings.icon;
            document.getElementById('headerFont').value = headerSettings.font;
            document.getElementById('headerColor').value = headerSettings.titleColor;
            document.getElementById('headerBgColor').value = headerSettings.bgColor;
            document.getElementById('headerTextColor').value = headerSettings.textColor;
        }

        // اعمال تنظیمات لوگو
        function applyLogoSettings() {
            document.getElementById('siteLogo').src = logoSettings.logoUrl;
            document.getElementById('logoPreview').src = logoSettings.logoUrl;
            
            // به‌روزرسانی تولتیپ لوگو
            updateLogoTooltip();
            
            // به‌روزرسانی مقادیر فرم
            document.getElementById('officeName').value = logoSettings.officeName;
            document.getElementById('officeAddress').value = logoSettings.officeAddress;
            document.getElementById('officePhone').value = logoSettings.officePhone;
            document.getElementById('officeHours').value = logoSettings.officeHours;
            document.getElementById('officeDescription').value = logoSettings.officeDescription;
        }

        // به‌روزرسانی تولتیپ لوگو
        function updateLogoTooltip() {
            const logoTooltip = document.getElementById('logoTooltip');
            logoTooltip.innerHTML = `
                <div><strong>${logoSettings.officeName}</strong></div>
                <div>${logoSettings.officeAddress}</div>
                <div>تلفن: ${logoSettings.officePhone}</div>
                <div>${logoSettings.officeHours}</div>
                <div style="margin-top: 8px; font-size: 0.8rem;">${logoSettings.officeDescription}</div>
            `;
        }

        // اعمال تنظیمات ظاهری
        function applyAppearanceSettings() {
            document.documentElement.style.setProperty('--primary-color', appearanceSettings.primaryColor);
            document.documentElement.style.setProperty('--secondary-color', appearanceSettings.secondaryColor);
            document.documentElement.style.setProperty('--accent-color', appearanceSettings.accentColor);
            document.documentElement.style.setProperty('--card-bg', appearanceSettings.cardBgColor);
            document.documentElement.style.setProperty('--text-color', appearanceSettings.textColor);
            document.documentElement.style.setProperty('--header-font', appearanceSettings.fontFamily);
            document.documentElement.style.setProperty('--service-font', appearanceSettings.serviceFont);
            document.body.style.fontFamily = appearanceSettings.fontFamily;
            
            // به‌روزرسانی مقادیر فرم
            document.getElementById('primaryColor').value = appearanceSettings.primaryColor;
            document.getElementById('secondaryColor').value = appearanceSettings.secondaryColor;
            document.getElementById('accentColor').value = appearanceSettings.accentColor;
            document.getElementById('cardBgColor').value = appearanceSettings.cardBgColor;
            document.getElementById('textColor').value = appearanceSettings.textColor;
            document.getElementById('fontFamily').value = appearanceSettings.fontFamily;
            document.getElementById('serviceFont').value = appearanceSettings.serviceFont;
        }

        // نمایش سرویس‌ها
        function renderServices() {
            const servicesGrid = document.getElementById('servicesGrid');
            servicesGrid.innerHTML = '';
            
            if (services.length === 0) {
                servicesGrid.innerHTML = '<div class="no-results">هیچ سرویسی یافت نشد</div>';
                return;
            }
            
            services.forEach(service => {
                const serviceCard = document.createElement('div');
                serviceCard.className = 'service-card';
                serviceCard.innerHTML = `
                    <div class="service-title" style="color: ${service.titleColor}; background: ${service.titleBg}">${service.title}</div>
                    <a href="${service.url}" class="service-link" target="_blank" style="color: ${service.buttonColor}; background: ${service.buttonBg}">${service.linkText}</a>
                `;
                servicesGrid.appendChild(serviceCard);
            });
        }

        // فیلتر کردن سرویس‌ها بر اساس جستجو
        function filterServices(searchTerm) {
            if (!searchTerm) {
                renderServices();
                return;
            }
            
            const filteredServices = services.filter(service => 
                service.title.includes(searchTerm)
            );
            
            const servicesGrid = document.getElementById('servicesGrid');
            servicesGrid.innerHTML = '';
            
            if (filteredServices.length === 0) {
                servicesGrid.innerHTML = '<div class="no-results">هیچ سرویسی با عبارت "' + searchTerm + '" یافت نشد</div>';
                return;
            }
            
            filteredServices.forEach(service => {
                const serviceCard = document.createElement('div');
                serviceCard.className = 'service-card';
                serviceCard.innerHTML = `
                    <div class="service-title" style="color: ${service.titleColor}; background: ${service.titleBg}">${service.title}</div>
                    <a href="${service.url}" class="service-link" target="_blank" style="color: ${service.buttonColor}; background: ${service.buttonBg}">${service.linkText}</a>
                `;
                servicesGrid.appendChild(serviceCard);
            });
        }

        // نمایش فرم‌های ویرایش در پنل مدیریت
        function renderAdminForms() {
            const adminForms = document.getElementById('adminForms');
            adminForms.innerHTML = '';
            services.forEach(service => {
                const editForm = document.createElement('div');
                editForm.className = 'edit-form';
                editForm.innerHTML = `
                    <div class="service-accordion">
                        <div class="accordion-header" onclick="toggleAccordion(this)">
                            ${service.title}
                            <i class="fas fa-chevron-down"></i>
                        </div>
                        <div class="accordion-content">
                            <h3>ویرایش ${service.title}</h3>
                            <label for="title-${service.id}">عنوان:</label>
                            <input type="text" id="title-${service.id}" value="${service.title}">
                            
                            <label for="url-${service.id}">آدرس سایت:</label>
                            <input type="text" id="url-${service.id}" value="${service.url}">
                            
                            <label for="linkText-${service.id}">متن لینک:</label>
                            <input type="text" id="linkText-${service.id}" value="${service.linkText}">
                            
                            <div class="style-controls">
                                <div class="style-control">
                                    <label for="titleColor-${service.id}">رنگ عنوان:</label>
                                    <input type="color" id="titleColor-${service.id}" value="${service.titleColor}">
                                </div>
                                <div class="style-control">
                                    <label for="titleBg-${service.id}">پس‌زمینه عنوان:</label>
                                    <input type="text" id="titleBg-${service.id}" value="${service.titleBg}">
                                </div>
                                <div class="style-control">
                                    <label for="buttonColor-${service.id}">رنگ دکمه:</label>
                                    <input type="color" id="buttonColor-${service.id}" value="${service.buttonColor}">
                                </div>
                                <div class="style-control">
                                    <label for="buttonBg-${service.id}">پس‌زمینه دکمه:</label>
                                    <input type="text" id="buttonBg-${service.id}" value="${service.buttonBg}">
                                </div>
                            </div>
                            
                            <button class="save-btn" onclick="saveService(${service.id})">ذخیره تغییرات</button>
                            <button class="delete-btn" onclick="deleteService(${service.id})">حذف سرویس</button>
                        </div>
                    </div>
                `;
                adminForms.appendChild(editForm);
            });
        }

        // باز و بسته کردن آکاردئون
        function toggleAccordion(header) {
            const content = header.nextElementSibling;
            const icon = header.querySelector('i');
            
            if (content.classList.contains('open')) {
                content.classList.remove('open');
                icon.classList.remove('fa-chevron-up');
                icon.classList.add('fa-chevron-down');
            } else {
                content.classList.add('open');
                icon.classList.remove('fa-chevron-down');
                icon.classList.add('fa-chevron-up');
            }
        }

        // ذخیره تغییرات یک سرویس
        function saveService(id) {
            const service = services.find(s => s.id === id);
            if (service) {
                service.title = document.getElementById(`title-${id}`).value;
                service.url = document.getElementById(`url-${id}`).value;
                service.linkText = document.getElementById(`linkText-${id}`).value;
                service.titleColor = document.getElementById(`titleColor-${id}`).value;
                service.titleBg = document.getElementById(`titleBg-${id}`).value;
                service.buttonColor = document.getElementById(`buttonColor-${id}`).value;
                service.buttonBg = document.getElementById(`buttonBg-${id}`).value;
                
                renderServices();
                saveData(); // ذخیره فوری تغییرات
                showNotification('تغییرات با موفقیت ذخیره شد', 'success');
            }
        }

        // حذف یک سرویس
        function deleteService(id) {
            if (services.length <= 1) {
                showNotification('حداقل باید یک سرویس وجود داشته باشد', 'error');
                return;
            }
            
            if (confirm('آیا از حذف این سرویس اطمینان دارید؟')) {
                services = services.filter(s => s.id !== id);
                renderServices();
                renderAdminForms();
                saveData(); // ذخیره فوری تغییرات
                showNotification('سرویس با موفقیت حذف شد', 'success');
            }
        }

        // افزودن سرویس جدید
        function addNewService() {
            const newService = {
                id: nextId++,
                title: "سرویس جدید",
                url: "https://example.com/new-service",
                linkText: "ورود به سایت",
                titleColor: "#ffeb3b",
                titleBg: "linear-gradient(135deg, #ffeb3b, #ffc107)",
                buttonColor: "#4caf50",
                buttonBg: "linear-gradient(135deg, #4caf50, #388e3c)"
            };
            
            services.push(newService);
            renderServices();
            renderAdminForms();
            saveData(); // ذخیره فوری تغییرات
            showNotification('سرویس جدید با موفقیت اضافه شد', 'success');
        }

        // تغییر تب‌ها
        function setupTabs() {
            const adminTabs = document.querySelectorAll('.admin-tab');
            const tabContents = document.querySelectorAll('.tab-content');
            
            adminTabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    const tabId = tab.getAttribute('data-tab');
                    
                    // غیرفعال کردن همه تب‌ها
                    adminTabs.forEach(t => t.classList.remove('active'));
                    tabContents.forEach(c => c.classList.remove('active'));
                    
                    // فعال کردن تب انتخاب شده
                    tab.classList.add('active');
                    document.getElementById(`${tabId}-tab`).classList.add('active');
                });
            });
        }

        // وارد کردن داده‌ها از JSON
        function importData() {
            const jsonData = document.getElementById('jsonData').value;
            
            if (!jsonData) {
                showNotification('لطفاً داده‌های JSON را وارد کنید', 'error');
                return;
            }
            
            try {
                const importedData = JSON.parse(jsonData);
                
                if (importedData.services) {
                    services = importedData.services;
                    nextId = services.length > 0 ? Math.max(...services.map(s => s.id)) + 1 : 5;
                }
                
                if (importedData.headerSettings) {
                    headerSettings = importedData.headerSettings;
                }
                
                if (importedData.logoSettings) {
                    logoSettings = importedData.logoSettings;
                }
                
                if (importedData.appearanceSettings) {
                    appearanceSettings = importedData.appearanceSettings;
                }
                
                if (importedData.footerIcons) {
                    footerIcons = importedData.footerIcons;
                }
                
                if (importedData.adminPassword) {
                    adminPassword = importedData.adminPassword;
                }
                
                renderServices();
                renderAdminForms();
                renderFooterIcons();
                renderFooterIconsList();
                applyHeaderSettings();
                applyLogoSettings();
                applyAppearanceSettings();
                
                saveData(); // ذخیره فوری تغییرات
                showNotification('داده‌ها با موفقیت وارد شدند', 'success');
            } catch (error) {
                console.error('خطا در وارد کردن داده‌ها:', error);
                showNotification('خطا در وارد کردن داده‌ها. لطفاً فرمت JSON را بررسی کنید.', 'error');
            }
        }

        // صادر کردن داده‌ها به JSON
        function exportData() {
            const dataToExport = {
                services,
                headerSettings,
                logoSettings,
                appearanceSettings,
                footerIcons,
                adminPassword
            };
            
            const jsonData = JSON.stringify(dataToExport, null, 2);
            document.getElementById('jsonData').value = jsonData;
            showNotification('داده‌ها با موفقیت در کادر متن صادر شدند', 'success');
        }

        // صادر کردن داده‌ها به Excel
        function exportToExcel() {
            try {
                // ایجاد workbook جدید
                const wb = XLSX.utils.book_new();
                
                // ایجاد worksheet برای سرویس‌ها
                const servicesData = services.map(service => ({
                    'شناسه': service.id,
                    'عنوان': service.title,
                    'آدرس سایت': service.url,
                    'متن لینک': service.linkText,
                    'رنگ عنوان': service.titleColor,
                    'پس‌زمینه عنوان': service.titleBg,
                    'رنگ دکمه': service.buttonColor,
                    'پس‌زمینه دکمه': service.buttonBg
                }));
                
                const wsServices = XLSX.utils.json_to_sheet(servicesData);
                XLSX.utils.book_append_sheet(wb, wsServices, 'سرویس‌ها');
                
                // ایجاد worksheet برای تنظیمات
                const settingsData = [
                    {'تنظیمات': 'عنوان سایت', 'مقدار': headerSettings.title},
                    {'تنظیمات': 'زیرعنوان', 'مقدار': headerSettings.subtitle},
                    {'تنظیمات': 'آیکون', 'مقدار': headerSettings.icon},
                    {'تنظیمات': 'رنگ عنوان', 'مقدار': headerSettings.titleColor},
                    {'تنظیمات': 'رنگ پس‌زمینه هدر', 'مقدار': headerSettings.bgColor},
                    {'تنظیمات': 'رنگ متن هدر', 'مقدار': headerSettings.textColor},
                    {'تنظیمات': 'فونت هدر', 'مقدار': headerSettings.font},
                    {'تنظیمات': 'نام دفتر', 'مقدار': logoSettings.officeName},
                    {'تنظیمات': 'آدرس', 'مقدار': logoSettings.officeAddress},
                    {'تنظیمات': 'تلفن', 'مقدار': logoSettings.officePhone},
                    {'تنظیمات': 'ساعات کاری', 'مقدار': logoSettings.officeHours},
                    {'تنظیمات': 'توضیحات', 'مقدار': logoSettings.officeDescription},
                    {'تنظیمات': 'رنگ اصلی', 'مقدار': appearanceSettings.primaryColor},
                    {'تنظیمات': 'رنگ ثانویه', 'مقدار': appearanceSettings.secondaryColor},
                    {'تنظیمات': 'رنگ تأکیدی', 'مقدار': appearanceSettings.accentColor},
                    {'تنظیمات': 'رنگ پس‌زمینه کارت‌ها', 'مقدار': appearanceSettings.cardBgColor},
                    {'تنظیمات': 'رنگ متن', 'مقدار': appearanceSettings.textColor},
                    {'تنظیمات': 'فونت اصلی', 'مقدار': appearanceSettings.fontFamily},
                    {'تنظیمات': 'فونت سرویس‌ها', 'مقدار': appearanceSettings.serviceFont}
                ];
                
                const wsSettings = XLSX.utils.json_to_sheet(settingsData);
                XLSX.utils.book_append_sheet(wb, wsSettings, 'تنظیمات');
                
                // ایجاد worksheet برای آیکون‌های فوتر
                const footerData = footerIcons.map((icon, index) => ({
                    'ردیف': index + 1,
                    'آیکون': icon.icon,
                    'آدرس': icon.url,
                    'متن راهنما': icon.tooltip
                }));
                
                const wsFooter = XLSX.utils.json_to_sheet(footerData);
                XLSX.utils.book_append_sheet(wb, wsFooter, 'آیکون‌های فوتر');
                
                // ذخیره فایل
                const fileName = `kafinet_data_${new Date().toISOString().split('T')[0]}.xlsx`;
                XLSX.writeFile(wb, fileName);
                
                showNotification('داده‌ها با موفقیت به Excel صادر شدند', 'success');
            } catch (error) {
                console.error('خطا در صادر کردن به Excel:', error);
                showNotification('خطا در صادر کردن داده‌ها به Excel', 'error');
            }
        }

        // وارد کردن داده‌ها از Excel
        function importFromExcel(file) {
            const reader = new FileReader();
            
            reader.onload = function(e) {
                try {
                    const data = new Uint8Array(e.target.result);
                    const workbook = XLSX.read(data, {type: 'array'});
                    
                    // خواندن sheet سرویس‌ها
                    if (workbook.Sheets['سرویس‌ها']) {
                        const servicesData = XLSX.utils.sheet_to_json(workbook.Sheets['سرویس‌ها']);
                        if (servicesData.length > 0) {
                            services = servicesData.map(item => ({
                                id: item['شناسه'] || nextId++,
                                title: item['عنوان'] || 'سرویس جدید',
                                url: item['آدرس سایت'] || 'https://example.com',
                                linkText: item['متن لینک'] || 'ورود به سایت',
                                titleColor: item['رنگ عنوان'] || '#ffeb3b',
                                titleBg: item['پس‌زمینه عنوان'] || 'linear-gradient(135deg, #ffeb3b, #ffc107)',
                                buttonColor: item['رنگ دکمه'] || '#4caf50',
                                buttonBg: item['پس‌زمینه دکمه'] || 'linear-gradient(135deg, #4caf50, #388e3c)'
                            }));
                            nextId = services.length > 0 ? Math.max(...services.map(s => s.id)) + 1 : 5;
                        }
                    }
                    
                    // خواندن sheet تنظیمات
                    if (workbook.Sheets['تنظیمات']) {
                        const settingsData = XLSX.utils.sheet_to_json(workbook.Sheets['تنظیمات']);
                        
                        settingsData.forEach(item => {
                            const setting = item['تنظیمات'];
                            const value = item['مقدار'];
                            
                            switch(setting) {
                                case 'عنوان سایت':
                                    headerSettings.title = value;
                                    break;
                                case 'زیرعنوان':
                                    headerSettings.subtitle = value;
                                    break;
                                case 'آیکون':
                                    headerSettings.icon = value;
                                    break;
                                case 'رنگ عنوان':
                                    headerSettings.titleColor = value;
                                    break;
                                case 'رنگ پس‌زمینه هدر':
                                    headerSettings.bgColor = value;
                                    break;
                                case 'رنگ متن هدر':
                                    headerSettings.textColor = value;
                                    break;
                                case 'فونت هدر':
                                    headerSettings.font = value;
                                    break;
                                case 'نام دفتر':
                                    logoSettings.officeName = value;
                                    break;
                                case 'آدرس':
                                    logoSettings.officeAddress = value;
                                    break;
                                case 'تلفن':
                                    logoSettings.officePhone = value;
                                    break;
                                case 'ساعات کاری':
                                    logoSettings.officeHours = value;
                                    break;
                                case 'توضیحات':
                                    logoSettings.officeDescription = value;
                                    break;
                                case 'رنگ اصلی':
                                    appearanceSettings.primaryColor = value;
                                    break;
                                case 'رنگ ثانویه':
                                    appearanceSettings.secondaryColor = value;
                                    break;
                                case 'رنگ تأکیدی':
                                    appearanceSettings.accentColor = value;
                                    break;
                                case 'رنگ پس‌زمینه کارت‌ها':
                                    appearanceSettings.cardBgColor = value;
                                    break;
                                case 'رنگ متن':
                                    appearanceSettings.textColor = value;
                                    break;
                                case 'فونت اصلی':
                                    appearanceSettings.fontFamily = value;
                                    break;
                                case 'فونت سرویس‌ها':
                                    appearanceSettings.serviceFont = value;
                                    break;
                            }
                        });
                    }
                    
                    // خواندن sheet آیکون‌های فوتر
                    if (workbook.Sheets['آیکون‌های فوتر']) {
                        const footerData = XLSX.utils.sheet_to_json(workbook.Sheets['آیکون‌های فوتر']);
                        if (footerData.length > 0) {
                            footerIcons = footerData.map(item => ({
                                icon: item['آیکون'],
                                url: item['آدرس'],
                                tooltip: item['متن راهنما']
                            }));
                        }
                    }
                    
                    renderServices();
                    renderAdminForms();
                    renderFooterIcons();
                    renderFooterIconsList();
                    applyHeaderSettings();
                    applyLogoSettings();
                    applyAppearanceSettings();
                    
                    saveData(); // ذخیره فوری تغییرات
                    showNotification('داده‌ها با موفقیت از Excel وارد شدند', 'success');
                } catch (error) {
                    console.error('خطا در وارد کردن از Excel:', error);
                    showNotification('خطا در وارد کردن داده‌ها از Excel', 'error');
                }
            };
            
            reader.readAsArrayBuffer(file);
        }


// event listener برای آپلود آیکون فوتر
document.getElementById('footerIconUpload').addEventListener('change', function(e) {
    const file = e.target.files[0];
    if (file) {
        const reader = new FileReader();
        reader.onload = function(e) {
            // ذخیره آیکون آپلود شده
            const uploadedIcon = e.target.result;
            
            // نمایش پیش‌نمایش آیکون آپلود شده
            const iconPreview = document.getElementById('iconPreview');
            iconPreview.className = '';
            iconPreview.innerHTML = `<img src="${uploadedIcon}" style="width: 30px; height: 30px; object-fit: contain;">`;
            
            // تنظیم مقدار select برای نشان دادن آیکون آپلود شده
            document.getElementById('iconSelect').value = 'custom-uploaded-icon';
            
            // ذخیره آیکون آپلود شده در یک متغیر موقت
            window.uploadedFooterIcon = uploadedIcon;
            
            showNotification('آیکون با موفقیت آپلود شد', 'success');
        };
        reader.readAsDataURL(file);
    }
});

        // نمایش آیکون‌های فوتر
        function renderFooterIcons() {
            const footerIconsContainer = document.getElementById('footerIcons');
            footerIconsContainer.innerHTML = '';
            
            footerIcons.forEach((item, index) => {
                const iconElement = document.createElement('div');
                iconElement.className = 'footer-icon';
                iconElement.innerHTML = `
                    <i class="${item.icon}"></i>
                    <div class="footer-tooltip">${item.tooltip}</div>
                `;
                
                iconElement.addEventListener('click', () => {
                    if (item.url) {
                        window.open(item.url, '_blank');
                    }
                });
                
                // امکان حذف آیکون با کلیک طولانی
                let pressTimer;
                iconElement.addEventListener('mousedown', () => {
                    pressTimer = setTimeout(() => {
                        if (confirm(`آیا از حذف آیکون "${item.tooltip}" اطمینان دارید؟`)) {
                            footerIcons.splice(index, 1);
                            renderFooterIcons();
                            renderFooterIconsList();
                            saveData();
                        }
                    }, 1000);
                });
                
                iconElement.addEventListener('mouseup', () => {
                    clearTimeout(pressTimer);
                });
                
                iconElement.addEventListener('mouseleave', () => {
                    clearTimeout(pressTimer);
                });
                
                footerIconsContainer.appendChild(iconElement);
            });
        }

        // نمایش لیست آیکون‌ها در مودال مدیریت
        function renderFooterIconsList() {
            const iconsList = document.getElementById('footerIconsListModal');
            iconsList.innerHTML = '<h3 style="margin-bottom: 10px; text-align: center;">آیکون‌های موجود</h3>';
            
            if (footerIcons.length === 0) {
                iconsList.innerHTML += '<p style="text-align: center; color: #777;">هیچ آیکونی وجود ندارد</p>';
                return;
            }
            
            footerIcons.forEach((item, index) => {
                const iconItem = document.createElement('div');
                iconItem.style.display = 'flex';
                iconItem.style.justifyContent = 'space-between';
                iconItem.style.alignItems = 'center';
                iconItem.style.padding = '10px';
                iconItem.style.marginBottom = '5px';
                iconItem.style.background = '#f5f5f5';
                iconItem.style.borderRadius = '5px';
                
                iconItem.innerHTML = `
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <div class="preview-icon">
                            <i class="${item.icon}"></i>
                        </div>
                        <div>
                            <div><strong>${item.tooltip}</strong></div>
                            <div style="font-size: 0.8rem; color: #777;">${item.url}</div>
                        </div>
                    </div>
                    <button class="delete-icon-btn" data-index="${index}" style="background: #f44336; color: white; border: none; padding: 5px 10px; border-radius: 5px; cursor: pointer;">حذف</button>
                `;
                
                iconsList.appendChild(iconItem);
            });
            
            // اضافه کردن event listener برای دکمه‌های حذف
            document.querySelectorAll('.delete-icon-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const index = parseInt(this.getAttribute('data-index'));
                    if (confirm(`آیا از حذف آیکون "${footerIcons[index].tooltip}" اطمینان دارید؟`)) {
                        footerIcons.splice(index, 1);
                        renderFooterIcons();
                        renderFooterIconsList();
                        saveData();
                    }
                });
            });
        }

        // پیش‌نمایش آیکون انتخاب شده
        function updateIconPreview() {
            const iconSelect = document.getElementById('iconSelect');
            const iconPreview = document.getElementById('iconPreview');
            iconPreview.className = iconSelect.value;
        }

        // مقداردهی اولیه
        document.addEventListener('DOMContentLoaded', function() {
            // بررسی وضعیت ذخیره‌سازی
            checkStorageStatus();
            
            // بارگذاری داده‌ها
            loadData();
            
            // اعمال تنظیمات
            renderServices();
            renderFooterIcons();
            applyHeaderSettings();
            applyLogoSettings();
            applyAppearanceSettings();
            renderAdminForms();
            setupTabs();
            
            // تنظیم event listeners
            const searchInput = document.getElementById('searchInput');
            searchInput.addEventListener('input', () => {
                filterServices(searchInput.value);
            });

            const adminLoginBtn = document.getElementById('adminLoginBtn');
            adminLoginBtn.addEventListener('click', () => {
                document.getElementById('loginModal').style.display = 'flex';
                document.getElementById('password').focus();
            });

            const cancelLogin = document.getElementById('cancelLogin');
            cancelLogin.addEventListener('click', () => {
                document.getElementById('loginModal').style.display = 'none';
                document.getElementById('password').value = '';
            });

            const submitLogin = document.getElementById('submitLogin');
            submitLogin.addEventListener('click', () => {
                const password = document.getElementById('password').value;
                if (password === adminPassword) {
                    document.getElementById('loginModal').style.display = 'none';
                    document.getElementById('adminPanel').style.display = 'block';
                    renderAdminForms();
                    document.getElementById('password').value = '';
                    showNotification('با موفقیت وارد شدید', 'success');
                } else {
                    showNotification('رمز عبور اشتباه است', 'error');
                    document.getElementById('password').value = '';
                    document.getElementById('password').focus();
                }
            });

            const logoutBtn = document.getElementById('logoutBtn');
            logoutBtn.addEventListener('click', () => {
                document.getElementById('adminPanel').style.display = 'none';
                showNotification('با موفقیت خارج شدید', 'success');
            });

            const addServiceBtn = document.getElementById('addServiceBtn');
            addServiceBtn.addEventListener('click', addNewService);

            const saveAllBtn = document.getElementById('saveAllBtn');
            saveAllBtn.addEventListener('click', saveData);

            const updateLogoBtn = document.getElementById('updateLogoBtn');
            updateLogoBtn.addEventListener('click', () => {
                logoSettings.officeName = document.getElementById('officeName').value;
                logoSettings.officeAddress = document.getElementById('officeAddress').value;
                logoSettings.officePhone = document.getElementById('officePhone').value;
                logoSettings.officeHours = document.getElementById('officeHours').value;
                logoSettings.officeDescription = document.getElementById('officeDescription').value;
                
                applyLogoSettings();
                saveData(); // ذخیره فوری تغییرات
                showNotification('اطلاعات دفتر با موفقیت بروزرسانی شد', 'success');
            });

            const removeLogoBtn = document.getElementById('removeLogoBtn');
            removeLogoBtn.addEventListener('click', () => {
                logoSettings.logoUrl = "https://via.placeholder.com/150/1a2a6c/ffffff?text=LOGO";
                applyLogoSettings();
                saveData(); // ذخیره فوری تغییرات
                showNotification('لوگو با موفقیت حذف شد', 'success');
            });

            const logoUpload = document.getElementById('logoUpload');
            logoUpload.addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        logoSettings.logoUrl = e.target.result;
                        applyLogoSettings();
                        saveData(); // ذخیره فوری تغییرات
                        showNotification('لوگو با موفقیت آپلود شد', 'success');
                    };
                    reader.readAsDataURL(file);
                }
            });

            // مدیریت رمز عبور
            const forgotPasswordBtn = document.getElementById('forgotPasswordBtn');
            forgotPasswordBtn.addEventListener('click', () => {
                document.getElementById('loginModal').style.display = 'none';
                document.getElementById('forgotPasswordModal').style.display = 'flex';
            });

            const changePasswordBtn = document.getElementById('changePasswordBtn');
            changePasswordBtn.addEventListener('click', () => {
                document.getElementById('loginModal').style.display = 'none';
                document.getElementById('changePasswordModal').style.display = 'flex';
            });

            const cancelForgotPassword = document.getElementById('cancelForgotPassword');
            cancelForgotPassword.addEventListener('click', () => {
                document.getElementById('forgotPasswordModal').style.display = 'none';
                document.getElementById('loginModal').style.display = 'flex';
            });

            const cancelChangePassword = document.getElementById('cancelChangePassword');
            cancelChangePassword.addEventListener('click', () => {
                document.getElementById('changePasswordModal').style.display = 'none';
                document.getElementById('loginModal').style.display = 'flex';
            });

            const submitNewPassword = document.getElementById('submitNewPassword');
            submitNewPassword.addEventListener('click', () => {
                const newPassword1 = document.getElementById('newPassword1').value;
                const newPassword2 = document.getElementById('newPassword2').value;
                
                if (newPassword1 && newPassword1 === newPassword2) {
                    adminPassword = newPassword1;
                    saveData();
                    document.getElementById('forgotPasswordModal').style.display = 'none';
                    document.getElementById('loginModal').style.display = 'flex';
                    showNotification('رمز عبور با موفقیت تغییر کرد', 'success');
                } else {
                    showNotification('رمزهای عبور مطابقت ندارند', 'error');
                }
            });

            const submitChangePassword = document.getElementById('submitChangePassword');
            submitChangePassword.addEventListener('click', () => {
                const currentPassword = document.getElementById('currentPassword').value;
                const newPassword1 = document.getElementById('newChangePassword1').value;
                const newPassword2 = document.getElementById('newChangePassword2').value;
                
                if (currentPassword === adminPassword) {
                    if (newPassword1 && newPassword1 === newPassword2) {
                        adminPassword = newPassword1;
                        saveData();
                        document.getElementById('changePasswordModal').style.display = 'none';
                        document.getElementById('loginModal').style.display = 'flex';
                        showNotification('رمز عبور با موفقیت تغییر کرد', 'success');
                    } else {
                        showNotification('رمزهای عبور جدید مطابقت ندارند', 'error');
                    }
                } else {
                    showNotification('رمز عبور فعلی اشتباه است', 'error');
                }
            });

            // دکمه دیباگ
            const debugBtn = document.getElementById('debugBtn');
            debugBtn.addEventListener('click', resetAllData);

            // event listeners برای تنظیمات هدر
            document.getElementById('headerTitle').addEventListener('input', () => {
                headerSettings.title = document.getElementById('headerTitle').value;
                applyHeaderSettings();
                saveData(); // ذخیره فوری تغییرات
            });
            
            document.getElementById('headerSubtitle').addEventListener('input', () => {
                headerSettings.subtitle = document.getElementById('headerSubtitle').value;
                applyHeaderSettings();
                saveData(); // ذخیره فوری تغییرات
            });
            
            document.getElementById('headerIcon').addEventListener('input', () => {
                headerSettings.icon = document.getElementById('headerIcon').value;
                applyHeaderSettings();
                saveData(); // ذخیره فوری تغییرات
            });
            
            document.getElementById('headerFont').addEventListener('change', () => {
                headerSettings.font = document.getElementById('headerFont').value;
                applyHeaderSettings();
                saveData(); // ذخیره فوری تغییرات
            });
            
            document.getElementById('headerColor').addEventListener('input', () => {
                headerSettings.titleColor = document.getElementById('headerColor').value;
                applyHeaderSettings();
                saveData(); // ذخیره فوری تغییرات
            });
            
            document.getElementById('headerBgColor').addEventListener('input', () => {
                headerSettings.bgColor = document.getElementById('headerBgColor').value;
                applyHeaderSettings();
                saveData(); // ذخیره فوری تغییرات
            });
            
            document.getElementById('headerTextColor').addEventListener('input', () => {
                headerSettings.textColor = document.getElementById('headerTextColor').value;
                applyHeaderSettings();
                saveData(); // ذخیره فوری تغییرات
            });

            // event listeners برای تنظیمات ظاهری
            document.getElementById('primaryColor').addEventListener('input', () => {
                appearanceSettings.primaryColor = document.getElementById('primaryColor').value;
                applyAppearanceSettings();
                saveData(); // ذخیره فوری تغییرات
            });
            
            document.getElementById('secondaryColor').addEventListener('input', () => {
                appearanceSettings.secondaryColor = document.getElementById('secondaryColor').value;
                applyAppearanceSettings();
                saveData(); // ذخیره فوری تغییرات
            });
            
            document.getElementById('accentColor').addEventListener('input', () => {
                appearanceSettings.accentColor = document.getElementById('accentColor').value;
                applyAppearanceSettings();
                saveData(); // ذخیره فوری تغییرات
            });
            
            document.getElementById('cardBgColor').addEventListener('input', () => {
                appearanceSettings.cardBgColor = document.getElementById('cardBgColor').value;
                applyAppearanceSettings();
                saveData(); // ذخیره فوری تغییرات
            });
            
            document.getElementById('textColor').addEventListener('input', () => {
                appearanceSettings.textColor = document.getElementById('textColor').value;
                applyAppearanceSettings();
                saveData(); // ذخیره فوری تغییرات
            });
            
            document.getElementById('fontFamily').addEventListener('change', () => {
                appearanceSettings.fontFamily = document.getElementById('fontFamily').value;
                applyAppearanceSettings();
                saveData(); // ذخیره فوری تغییرات
            });
            
            document.getElementById('serviceFont').addEventListener('change', () => {
                appearanceSettings.serviceFont = document.getElementById('serviceFont').value;
                applyAppearanceSettings();
                saveData(); // ذخیره فوری تغییرات
            });

            // event listeners برای وارد کردن و صادر کردن داده‌ها
            document.getElementById('importDataBtn').addEventListener('click', importData);
            document.getElementById('exportDataBtn').addEventListener('click', exportData);
            document.getElementById('exportExcelBtn').addEventListener('click', exportToExcel);

            // event listener برای آپلود فایل Excel
            document.getElementById('excelImport').addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (file) {
                    importFromExcel(file);
                }
            });

            // event listener برای آپلود آیکون هدر
            document.getElementById('headerIconUpload').addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        headerSettings.icon = 'custom-icon';
                        const headerIconElement = document.getElementById('headerIconElement');
                        headerIconElement.className = 'header-icon';
                        headerIconElement.innerHTML = `<img src="${e.target.result}" style="width: 40px; height: 40px;">`;
                        applyHeaderSettings();
                        saveData(); // ذخیره فوری تغییرات
                        showNotification('آیکون هدر با موفقیت آپلود شد', 'success');
                    };
                    reader.readAsDataURL(file);
                }
            });

            // event listener برای آپلود فونت
            document.getElementById('fontUpload').addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        const fontName = file.name.split('.')[0];
                        const fontFace = new FontFace(fontName, `url(${e.target.result})`);
                        
                        fontFace.load().then(function(loadedFont) {
                            document.fonts.add(loadedFont);
                            appearanceSettings.fontFamily = fontName + ', ' + appearanceSettings.fontFamily;
                            applyAppearanceSettings();
                            saveData(); // ذخیره فوری تغییرات
                            showNotification('فونت با موفقیت آپلود شد', 'success');
                        }).catch(function(error) {
                            console.error('خطا در بارگذاری فونت:', error);
                            showNotification('خطا در بارگذاری فونت', 'error');
                        });
                    };
                    reader.readAsDataURL(file);
                }
            });

            // event listener برای کلیک روی لوگو
            document.getElementById('siteLogo').addEventListener('click', function() {
                const officeInfoContent = document.getElementById('officeInfoContent');
                officeInfoContent.innerHTML = `
                    <div style="text-align: center; margin-bottom: 20px;">
                        <h3>${logoSettings.officeName}</h3>
                    </div>
                    <div style="margin-bottom: 15px;">
                        <strong>آدرس:</strong> ${logoSettings.officeAddress}
                    </div>
                    <div style="margin-bottom: 15px;">
                        <strong>تلفن:</strong> ${logoSettings.officePhone}
                    </div>
                    <div style="margin-bottom: 15px;">
                        <strong>ساعات کاری:</strong> ${logoSettings.officeHours}
                    </div>
                    <div style="margin-bottom: 15px;">
                        <strong>توضیحات:</strong> ${logoSettings.officeDescription}
                    </div>
                `;
                document.getElementById('officeInfoModal').style.display = 'flex';
            });

            // event listener برای بستن مودال اطلاعات دفتر
            document.getElementById('closeOfficeInfo').addEventListener('click', function() {
                document.getElementById('officeInfoModal').style.display = 'none';
            });

            // مدیریت فوتر
            // پیش‌نمایش آیکون
            updateIconPreview();
            
            // event listener برای تغییر آیکون
            document.getElementById('iconSelect').addEventListener('change', updateIconPreview);
            
            // event listener برای دکمه مدیریت فوتر
            document.getElementById('footerAdminBtn').addEventListener('click', function() {
                document.getElementById('footerModal').style.display = 'flex';
                renderFooterIconsList();
            });
            
            // event listener برای بستن مودال
            document.getElementById('cancelFooter').addEventListener('click', function() {
                document.getElementById('footerModal').style.display = 'none';
            });
            
            // event listener برای افزودن آیکون جدید
            document.getElementById('addFooterIcon').addEventListener('click', function() {
                const iconSelect = document.getElementById('iconSelect');
                const iconUrl = document.getElementById('iconUrl').value;
                const iconTooltip = document.getElementById('iconTooltip').value;
                
                if (!iconUrl || !iconTooltip) {
                    alert('لطفاً تمام فیلدها را پر کنید');
                    return;
                }
                
                const newIcon = {
                    icon: iconSelect.value,
                    url: iconUrl,
                    tooltip: iconTooltip
                };
                
                footerIcons.push(newIcon);
                renderFooterIcons();
                renderFooterIconsList();
                saveData();
                
                // پاک کردن فیلدها
                document.getElementById('iconUrl').value = '';
                document.getElementById('iconTooltip').value = '';
                
                showNotification('آیکون جدید با موفقیت اضافه شد', 'success');
            });
        });
    </script>
</body>
</html>
